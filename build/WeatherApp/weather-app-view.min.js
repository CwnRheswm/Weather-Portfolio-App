define(["jquery","underscore","backbone","../Geocode/geocodes.min","../Geocode/geocodeView.min","../Weather/weathers.min","../Current/currentView.min","../Forecast/forecastView.min"],function(a,b,c,d,e,f,g,h){"use strict";var i="localhost"===window.location.hostname,j=c.View.extend({el:"#weather-app",events:{"keypress #city-search":"checkForEnter","click #current-btn":function(a){this.validateInput(a),this.toggleCurrentWeatherBoard(a)},"click #forecast-btn":function(a){this.validateInput(a),this.toggleForecastWeatherBoard(a)},"click #history-btn":function(a){this.validateInput(a),this.toggleHistoryWeatherBoard(a)}},initialize:function(){this.$input=this.$("#city-search"),this.$current=a("#weather-current"),this.$forecast=a("#weather-forecast"),this.geocodes=new d,this.listenTo(this.geocodes,"change:ready",this.addGeocode),this.weathers=new f,this.listenTo(this.weathers,"change:ready",this.addWeather)},render:function(){this.weathers.length?this.$current.show():this.$current.hide()},addWeather:function(a){var b=new h({model:a});this.$forecast.append(b.render().el)},addGeocode:function(){var a=this.geocodes.models[0];return 1==this.weathers.length?(this.weathers.models[0].set("city",a.get("city")),this.weathers.models[0].set("state",a.get("state")),this.weathers.models[0].set("latitude",Math.round(a.get("latitude"))),this.weathers.models[0].set("longitude",Math.round(a.get("longitude"))),void this.weathers.models[0].sync()):void this.weathers.create({city:a.get("city"),state:a.get("state"),latitude:Math.round(a.get("latitude")),longitude:Math.round(a.get("longitude"))})},retrieveCoordinates:function(a){return this.geocodes.models[0].get("city")!==a[0].trim()||this.geocodes.models[0].get("state")!==a[1].trim()?1===this.geocodes.length?(this.geocodes.models[0].set("city",a[0].trim()),this.geocodes.models[0].set("state",a[1].trim()),void this.geocodes.models[0].sync()):void this.geocodes.create({city:a[0].trim(),state:a[1].trim()}):void 0},validateInput:function(a){if(i)return this.$input[0].value="San Fransokyo, CA",this.retrieveCoordinates(["San Fransokyo","CA"]),console.log(a),console.log(a.target.classList),void a.target.classList.toggle("activated");var b=this.$input.val().trim();if(!b)return void alert("You Need To Enter a City and State first");var c=b.split(",");return 2!==c.length?void alert('Enter The City and State in the form "City, State"'):(console.log(a),console.log(a.target),a.target.classList.toggle("activated"),void this.retrieveCoordinates(c))},checkForEnter:function(b){b.which===ENTER_KEY&&a("#current-btn").trigger("click")},toggleCurrentWeatherBoard:function(){this.$current[0].classList.toggle("opened")},toggleForecastWeatherBoard:function(){this.$forecast[0].classList.toggle("opened")},toggleHistoryWeatherBoard:function(){this.$history[0].classList.toggle("opened")}});return j});